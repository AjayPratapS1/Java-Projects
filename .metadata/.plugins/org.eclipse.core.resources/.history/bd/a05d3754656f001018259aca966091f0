package com.jdbcp.pr;

import java.sql.*;
import java.util.*;

public class UpdateTableData {

	public static void main(String[] args) {
		Connection con = null;
		PreparedStatement pstmt = null;
		ResultSet rs = null;
		Scanner sc = new Scanner(System.in);

		try {

			Class.forName("com.mysql.cj.jdbc.Driver");

			con = DriverManager.getConnection("jdbc:mysql://localhost:3306/Hospital", "root", "A#@21jja$y2");

			String sql = "UPDATE patient SET name = ? WHERE name = ?";
			pstmt = con.prepareStatement(sql);
            System.out.println("Enter New Name to Replace: ");
            String newName = sc.nextLine();
            System.out.println("Enter Old Name to Replace: ");
            String oldName = sc.nextLine();
			pstmt.setString(1, newName);
			pstmt.setString(2, oldName);

			int rows = pstmt.executeUpdate();

			if (rows > 0) {
				System.out.println("Data updated successfully! Rows affected: " + rows);
				// Query the student table
				 rs = pstmt.executeQuery("SELECT * FROM patient");

				// Process result
				while (rs.next()) {
					System.out.println("ID: " + rs.getInt("id") + 
									   ", Name: " + rs.getString("name") + 
									   ", Age: " + rs.getInt("age") + 
									   ", Disease: " + rs.getString("disease"));
				}
			} else {
				System.out.println("No data found with the name " + oldName);
			}

		} catch (Exception e) {
			e.printStackTrace();
		} finally {

			try {
				if (pstmt != null)
					pstmt.close();
				if (con != null)
					con.close();
				if(rs!=null) {
					rs.close();
				}
			} catch (SQLException se) {
				se.printStackTrace();
			}
		}
	}
}
